.. _xmlApplication:

****************************************
How to create a XML based application ?
****************************************

In the Tutorials, we explain how to create simple applications.
A XML based application, is defined by an "application bundle" (like a bundle but with some differences that we will 
described further).

Application bundle
-------------------

This "application bundle" contains a base configuration to run when the application is launched and lists the required 
bundles for this configuration. 

Like a bundle, the application folder needs the CMake files and a plugin.xml file. The first difference, is that the 
*Properties.cmake* ``TYPE`` is ``APP`` instead of ``BUNDLE``.
The second difference is the line:

.. code-block:: cmake

    bundleParam(appXml PARAM_LIST config PARAM_VALUES tutoDataServiceBasicConfig)
    
It defines the main configuration to be launched by the application (see :ref:`Properties.cmake`).

The main configuration should be written in the ``plugin.xml`` file in a ``<extension implements="::fwServices::registry::AppConfig">``
tag (see :ref:`tuto01`).

.. _profile.xml: 

profile.xml
------------

The Properties.cmake of an application allows to generate the ``profile.xml``, it is the file that describes the bundles
to use in the application and it is used to tell the ``fwlauncher`` which application to run.

Remember that to launch an application, we use:

.. code::

    bin/fwlauncher share/<myApplication>_<version>/profile.xml
    

The following profile.xml generated for :ref:`tuto01`.

.. code-block:: xml

    <!-- WARNING, this file is GENERATED by FW4SPL CMake-based build system from CMake/build/profile.xml.in -->
    <!-- DO NOT EDIT MANUALLY !!! -->

    <profile name="Tuto01Basic" version="0.1" check-single-instance="false">

        <activate id="Tuto01Basic" version="0.1" />
        <activate id="appXml" version="0.2" >
            <param id="config" value="tutoBasicConfig" />
        </activate>
        <activate id="dataReg" version="0.1" />
        <activate id="gui" version="0.1" />
        <activate id="guiQt" version="0.1" />
        <activate id="servicesReg" version="0.1" />

        <start id="appXml" />
        <start id="guiQt" />

    </profile>

activate:
    List of bundles used in this application. We see the parameter given to *appXML* bundle.
    
start:
    List of bundles to start when the application is launched. Basically, there are few bundles to start at the beginning:
    
    - *appXML*: to launch the configuration
    - *guiQt*: to launch qt event loop for application using GUI
    - *memory*: to manage image and mesh buffers

    The other bundles will be started according to the XML <requirement> tags of the bundles, or when a service is used in 
    an XML configuration and its bundle is not started. That way we only have the minimum number of DLLs loaded.