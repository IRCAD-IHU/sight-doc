<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title>FW4SPL</title><meta name="generator" content="Hovercraft! 1.0 http://regebro.github.com/hovercraft"></meta><meta name="author" content="Flavien Bridault"></meta><meta name="description" content="FW4SPL, a framework for applications based on medical imaging"></meta><meta name="keywords" content="presentation"></meta><link rel="stylesheet" href="css/hovercraft.css" media="all"></link><link rel="stylesheet" href="css/impressConsole.css" media="all"></link><link rel="stylesheet" href="css/highlight.css" media="all"></link><link rel="stylesheet" href="css/presentation.css" media="screen,projection"></link></head><body class="impress-not-supported"><div id="impress" data-transition-duration="1250"><div class="step step-level-1" step="0" id="circle-no-background" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="0" data-z="0"><div class="line-block"><br></br><br></br><br></br></div><h1 id="fw4spl-a-framework-for-applications-based-on-medical-imaging">FW4SPL, a framework for applications based on medical imaging.</h1><div class="line-block"><br></br></div><p><strong>Flavien Bridault</strong></p><p><em>RMLL 2015 - Beauvais, Wednesday, 8th 2015</em></p></div><div class="step step-level-1 text-small" step="1" data-y="1500" data-rotate-z="90" data-rotate-x="0" data-rotate-y="0" data-scale="1" data-x="0" data-z="0"><h1 id="ircad-strasbourg-france">IRCAD (Strasbourg, France)</h1><img src="images/ircad.jpg" width="70%"></img><ul><li>Institut de Recherche contre les Cancers de l'Appareil Digestif</li><li>Created by Jacques Marescaux in 1994</li><li>Training center - Research</li></ul><div class="notes"><ul><li>IRCAD is a research institute against digestive system cancers.</li><li>It is known worldwide especially because it is a training center, where 4000 surgeons/year attend courses on mini-invasive and laparoscopic surgery.</li><li>There are also two research and development teams. One about Robotics, and an another one about Computer Vision. FW4SPL is the framework developed by this team.</li></ul></div></div><div class="step step-level-1 text-small" step="2" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="1" data-x="0" data-y="3000" data-z="0"><h1 id="ihu-strasbourg">IHU Strasbourg</h1><img src="images/ihu.jpg" width="80%"></img><ul><li>Institut Hospitalier Universitaire</li><li>Mini-invasive surgery guided by image</li></ul><div class="notes"><ul><li>IHU is located next to IRCAD.</li><li>It is a research center about mini-invasive surgery guided by image.</li><li>IHU also contributes to FW4SPL.</li></ul></div></div><div class="step step-level-1" step="3" data-y="4500" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="1" data-x="0" data-z="0"><h1 id="presentation-purpose">Presentation purpose</h1><ul><li>Why IRCAD R&amp;D team has developed FW4SPL ?</li><li>Explain the design</li><li>Show the main features</li><li>Help to start developing</li></ul></div><div class="step step-level-1" step="4" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="1" data-x="0" data-y="6000" data-z="0"><h1 id="fw4spl-meaning">FW4SPL meaning</h1><ul><li>FrameWork for Software Production Line</li><li>Nickname: <em>F4S</em> -&gt; <em>Forces</em> [f&#x254;&#x281;sjz]</li></ul><div class="notes"><ul><li>Also a disclaimer</li></ul></div></div><div class="step step-level-1" step="5" id="ircad-context" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="1" data-x="0" data-y="7500" data-z="0"><h1 id="ircad-context">IRCAD context</h1><img src="images/patient.png" width="30%"></img><div class="notes"><ul><li>At IRCAD, we make prototypes/PoC of software based on medical imaging</li><li>Our data is the patient</li><li>Historically we have worked on different steps of the image process</li></ul></div></div><div class="step step-level-1" step="6" data-x="-300" data-y="7200" data-scale="0.4" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-z="0"><div class="legend">Viewer/Segmentation</div>
<video width="800" height="600" controls>
   <source src="https://www.flickr.com/video_download.gne?id=23187333024" >
   Your browser does not support the video tag.
</video></div><div class="step step-level-1" step="7" data-x="-600" data-y="7300" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="0.4" data-z="0"><div class="legend">Planning</div>
<video width="800" height="600" controls>
   <source src="https://www.flickr.com/video_download.gne?id=24020554236" >
   Your browser does not support the video tag.
</video><div class="notes"><p>Thanks to the 3D segmentation, we can help the surgeon to analyse a patient pathology. We worked on tools that help to plan the surgery. This activity has led to create a start-up called Visible Patient.</p></div></div><div class="step step-level-1" step="8" data-y="7700" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="0.4" data-x="-900" data-z="0"><div class="legend">Simulation</div>
<video width="800" height="600" controls>
   <source src="https://www.flickr.com/video_download.gne?id=23419875623" >
   Your browser does not support the video tag.
</video><div class="notes"><p>We also worked on medical simulators in laparoscopy. Laparoscopy is a way to perform a surgery with only small incisions in the abdomen. Surgeons interact with mechanical instruments and watch the organs through camera. Simulators help them to train without a . This activity has led to create a start-up called Digital Trainers.</p></div></div><div class="step step-level-1" step="9" data-y="7800" data-x="-600" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="0.4" data-z="0"><div class="legend">Augmented reality</div>
<video width="800" height="600" controls loop>
   <source src="https://www.flickr.com/video_download.gne?id=23938494632" >
   Your browser does not support the video tag.
</video><div class="notes"><p>Today we are focused on augmented reality. In laparoscopy, the surgeon has a very tight field of view. We superimpose informations on the video to help them during the surgery, for instance here, the location of the tumor on a liver.</p></div></div><div class="step step-level-1" step="10" data-y="7500" data-scale="1.2" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-x="-300" data-z="0"></div><div class="step step-level-1 text-small" step="11" data-y="9000" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="1.2" data-x="0" data-z="0"><h1 id="ircad-r-d-team">IRCAD R&amp;D team</h1><img src="images/team.jpg" width="80%"></img><ul><li>Researchers (3)</li><li>Engineers (7)</li><li>Phd. students (3)</li><li>Trainees (6)</li><li>Internships (4)</li></ul><div class="notes"><ul><li>Around 20 people</li></ul></div></div><div class="step step-level-1" step="12" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="1.2" data-x="300" data-y="10500" data-z="0"><h1 id="why-a-framework">Why a framework ?</h1><ul><li>Quick development, reuse source code</li><li>Intensive use of open source libraries (boost, Qt, VTK, ITK,...)</li><li>Integrate trainees/students/researchers/partners code</li></ul><div class="notes"><ul><li>software/prototype - Windows, OSX, Linux, Android, IOs</li><li>reuse source code</li><li>we don't want people to work on different library versions, with different options,...</li><li>we need to integrate the different applications/fragmented code</li></ul></div></div><div class="step step-level-1" step="13" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="1.2" data-x="600" data-y="12000" data-z="0"><h1 id="fw4spl-characteristics">FW4SPL characteristics</h1><ul><li>Object/services design</li><li>Component based (inspired by <a href="http://www.osgi.org">OSGi</a>)</li><li>Applications built in XML</li><li>Developed in C++</li><li>Multi platforms (Windows, Linux, OSX, Android)</li><li>Dependencies on many open source libraries</li><li>Licensed under <strong>LGPL</strong></li></ul><div class="notes"><ul><li>To match all these goals...</li><li>XML, not common to build applications</li></ul></div></div><div class="step step-level-1" step="14" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="1.2" data-x="900" data-y="13500" data-z="0"><h1 id="important-dates">Important dates</h1><ul><li>2004 : creation of FW4SPL project</li><li>2009 : FW4SPL became open-source (LGPL)</li><li>2010-2011 : PoC <strong>Sofa</strong> and <strong>Kinect</strong> (Altran-Est)</li><li>2013 : Creation of the FW4SPL board</li></ul><div class="notes"><ul><li>Sofa: biomechanical engine</li><li>Altran: proof that FW4SPL could be used outside IRCAD</li><li>Visible Patient was created in 2013 to commercialize the planning applications,...</li></ul></div></div><div class="step step-level-1 square-background" step="15" data-x="2900" data-rotate-z="180" data-rotate-x="0" data-rotate-y="0" data-scale="1.2" data-y="15000" data-z="0"><h1 id="outline">Outline</h1><ul><li><em>Object/Service approach</em></li><li>Communication</li><li>Component based approach</li><li>Discussion</li><li>Getting started</li></ul></div><div class="step step-level-1" step="16" data-x="4400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="270" data-scale="1.2" data-y="16500" data-z="0"><h1 id="what-is-the-object-service-approach">What is the Object/Service approach ?</h1></div><div class="step step-level-1" step="17" data-x="5900" data-rotate-x="0" data-rotate-y="0" data-rotate-z="360" data-scale="1.2" data-y="18000" data-z="0"><h1 id="classic-object-oriented-approach">Classic object-oriented approach</h1><ul><li>an object (i.e. an image) is represented by a class.</li></ul></div><div class="step step-level-1 centered" step="18" data-y="18270" data-scale="0.5" data-rotate-x="0" data-rotate-y="0" data-rotate-z="450" data-x="7400" data-z="0"><img src="images/Image.png" width="80%"></img></div><div class="step step-level-1" step="19" data-scale="1" data-y="18520" data-rotate-x="0" data-rotate-y="0" data-rotate-z="540" data-x="8900" data-z="0"><ul><li>this class contains all functionalities working on the object (read, write, filter, visualize, ...)</li></ul></div><div class="step step-level-1 centered" step="20" data-y="18770" data-scale="0.5" data-rotate-x="0" data-rotate-y="0" data-rotate-z="630" data-x="10400" data-z="0"><img src="images/Image04.png" width="80%"></img></div><div class="step step-level-1" step="21" data-scale="1" data-x="11900" data-rotate-x="0" data-rotate-y="0" data-rotate-z="720" data-y="19020" data-z="0"><h1 id="limits-of-this-approach">Limits of this approach</h1><ul><li>Too many methods in the class, hard to maintain</li><li>Many dependencies required even if you only need a single method.</li><li>Collaborative work harder</li></ul><h2 id="solution">Solution</h2><ul><li>Split data and functions</li></ul><div class="notes"><ul><li>Too many functions, if team continue to add functions</li><li>Many dependencies required (itk,vtk,qt,dcmtk,...) even if you just need  to crop an image</li><li>Everyone work on the same file</li></ul></div></div><div class="step step-level-1" step="22" data-rotate-x="0" data-rotate-y="0" data-rotate-z="810" data-scale="1" data-x="13400" data-y="19270" data-z="0"><h1 id="service">Service</h1><ul><li>Only one functionality (Read, Crop, Visualize...)</li><li>Class of services (IReader, IOperator, IVisu)</li><li>State pattern</li></ul><div class="notes"><ul><li>to this end, we use to concept of service</li><li>we can observe that for each process, we always have to repeat the same execution pattern, life cycle, configure, then initialize, update and stop</li><li>update can be repeated</li></ul></div></div><div class="step step-level-1 centered" step="23" data-y="19670" data-scale="0.8" data-rotate-x="0" data-rotate-y="0" data-rotate-z="900" data-x="14900" data-z="0"><img src="images/state.png"></img><div class="notes"><ul><li>transitions, on ne peut pas passer de configure &#xE0; stop</li><li>We need to store data into it</li></ul></div></div><div class="step step-level-1 centered" step="24" data-scale="1" data-x="16400" data-y="19470" data-rotate-x="0" data-rotate-y="0" data-rotate-z="990" data-z="0"><p><em>Service approach example</em></p><img src="images/IService02.png" width="120%"></img><div class="notes"><ul><li>Common interface 4 methods</li><li>sub-classes for each type</li><li>one service for each functionality</li></ul></div></div><div class="step step-level-1" step="25" data-scale="0.15" data-x="16350" data-y="19830" data-rotate-x="0" data-rotate-y="0" data-rotate-z="1080" data-z="0"><h1 id="dcmtkreadersrv">DcmtkReaderSrv</h1><ul><li>configure() : verify if url is ok</li><li>start() : do nothing</li><li>update() : read the data ( equivalent to <strong>readImageFromPacsWithDcmtk()</strong> )</li><li>stop() : do nothing</li></ul></div><div class="step step-level-1" step="26" data-x="16515" data-rotate-x="0" data-rotate-y="0" data-rotate-z="1170" data-scale="0.15" data-y="20190" data-z="0"><h1 id="itkcropoperatorsrv">ItkCropOperatorSrv</h1><ul><li>configure() : verify if the cropping region is valid</li><li>start() : do nothing</li><li>update() : compute the cropping on image and set the new data (equivalent to <strong>cropImageWithItk</strong> )</li><li>stop() : do nothing</li></ul></div><div class="step step-level-1" step="27" data-x="16875" data-rotate-x="0" data-rotate-y="0" data-rotate-z="1260" data-scale="0.15" data-y="20550" data-z="0"><h1 id="vtkqtvisusrv">VtkQtVisuSrv</h1><ul><li>configure() : verify if the screen support this size</li><li>start() : initialize Qt frame and vtk pipeline and show the frame</li><li>update() : check the buffer, if it has changed, refresh the vtk pipeline</li><li>stop() : destroy vtk pipeline and uninitialize Qt frame.</li></ul><div class="notes"><ul><li>configure() : verify if the screen support this size</li><li>start() : initialize Qt frame and vtk pipeline and show the frame (image is not shown if image buffer is null )</li><li>update() : check if the buffer has be changed, if true, refresh the vtk pipeline to show negato</li><li>stop() : destroy vtk pipeline and uninitialize Qt frame.</li></ul></div></div><div class="step step-level-1" step="28" data-y="21150" data-scale="1" data-rotate-x="0" data-rotate-y="0" data-rotate-z="1350" data-x="17235" data-z="0"><h1 id="application-description-in-xml">Application description in XML</h1><ul><li>Objects and services classes are registered dynamically</li><li>Instances are created by a factory</li><li>Application launcher read a XML configuration file</li></ul></div><div class="step step-level-1 text-small" step="29" data-x="18735" data-rotate-x="0" data-rotate-y="0" data-rotate-z="1440" data-scale="1" data-y="21750" data-z="0"><h1 id="xml-configuration-file">XML configuration file</h1><pre class="highlight code xml"><span class="nt">&lt;object</span> <span class="na">type=</span><span class="s">"::fwData::Image"</span><span class="nt">&gt;</span>

    <span class="nt">&lt;service</span> <span class="na">uid=</span><span class="s">"myFrame"</span> <span class="na">impl=</span><span class="s">"DefaultFrame"</span> <span class="na">type=</span><span class="s">"IFrame"</span> <span class="nt">&gt;</span>
        <span class="nt">&lt;gui&gt;</span>
            <span class="nt">&lt;frame&gt;</span>
                <span class="nt">&lt;minSize</span> <span class="na">width=</span><span class="s">"800"</span> <span class="na">height=</span><span class="s">"600"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/frame&gt;</span>
        <span class="nt">&lt;/gui&gt;</span>
        <span class="nt">&lt;registry&gt;</span>
            <span class="nt">&lt;view</span> <span class="na">uid=</span><span class="s">"myVisu"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/registry&gt;</span>
    <span class="nt">&lt;/service&gt;</span>

    <span class="nt">&lt;service</span> <span class="na">uid=</span><span class="s">"myVisu"</span> <span class="na">impl=</span><span class="s">"vtkSimpleNegatoRenderer"</span> <span class="na">type=</span><span class="s">"IRender"</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;service</span> <span class="na">uid=</span><span class="s">"myReader"</span> <span class="na">impl=</span><span class="s">"VtkImageReader"</span> <span class="na">type=</span><span class="s">"IReader"</span> <span class="nt">&gt;</span>
        <span class="nt">&lt;filename</span> <span class="na">path=</span><span class="s">"./TutoData/patient1.vtk"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/service&gt;</span>

    <span class="nt">&lt;start</span> <span class="na">uid=</span><span class="s">"myFrame"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;start</span> <span class="na">uid=</span><span class="s">"myVisu"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;start</span> <span class="na">uid=</span><span class="s">"myReader"</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;update</span> <span class="na">uid=</span><span class="s">"myReader"</span><span class="nt">/&gt;</span>    <span class="c">&lt;!-- Read the image on filesystem --&gt;</span>
    <span class="nt">&lt;update</span> <span class="na">uid=</span><span class="s">"myVisu"</span><span class="nt">/&gt;</span>      <span class="c">&lt;!-- Refresh the visu --&gt;</span>

<span class="nt">&lt;/object&gt;</span></pre></div><div class="step step-level-1" step="30" data-rotate-x="0" data-rotate-y="0" data-rotate-z="1530" data-scale="1" data-x="20235" data-y="22350" data-z="0"><h1 id="problem">Problem</h1><h2 id="and-if-we-read-a-new-image-later">And if we read a new image later ?</h2><ul><li>We can no longer call <strong>update()</strong> of the visualization from the xml</li><li><em>How to automate the call ?</em></li></ul></div><div class="step step-level-1 square-background" step="31" data-y="23850" data-rotate-z="90" data-rotate-x="0" data-rotate-y="0" data-scale="1" data-x="21735" data-z="0"><h1 id="id1">Outline</h1><ul><li>Object/Service approach</li><li><em>Communication</em></li><li>Component based approach</li><li>Discussion</li><li>Getting started</li></ul></div><div class="step step-level-1" step="32" data-y="25350" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="1" data-x="23235" data-z="0"><h1 id="communication">Communication</h1><ul><li><dl><dt><em>Signals/Slots</em> (inspired by Qt)</dt><dd><ul><li>Data -&gt; Service</li><li>Service &lt;-&gt; Service</li></ul></dd></dl></li><li><dl><dt>Slot call</dt><dd><ul><li>synchronous</li><li>asynchronous</li></ul></dd></dl></li></ul></div><div class="step step-level-1 centered" step="33" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="1" data-x="24735" data-y="26850" data-z="0"><img src="images/sigslot.png" width="100%"></img><div class="line-block"><br></br><br></br><br></br><br></br><br></br><br></br></div></div><div class="step step-level-1 text-small" step="34" data-x="24725" data-y="26700" data-scale="0.6" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-z="0"><pre class="highlight code c++"><span class="kt">void</span> <span class="n">DcmtkReaderSrv</span><span class="o">::</span><span class="n">update</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// Load an image using dcmtk
</span>    <span class="n">Dcmtk</span><span class="o">::</span><span class="n">Image</span> <span class="n">img</span><span class="p">;</span>
    <span class="p">...</span>

    <span class="n">Image</span><span class="o">*</span> <span class="n">img</span> <span class="o">=</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">getObject</span><span class="o">&lt;</span><span class="n">Image</span><span class="o">&gt;</span><span class="p">();</span>

    <span class="c1">// Convert dcmtk image data in our format
</span>    <span class="n">img</span><span class="o">-&gt;</span><span class="n">createImage</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">size</span><span class="p">);</span>

    <span class="c1">// Emit the signal "modified"
</span>    <span class="n">Signal</span><span class="o">*</span> <span class="n">sig</span> <span class="o">=</span> <span class="n">img</span><span class="o">-&gt;</span><span class="n">signal</span><span class="p">(</span><span class="s">"modified"</span><span class="p">);</span>
    <span class="n">sig</span><span class="o">-&gt;</span><span class="n">asyncEmit</span><span class="p">();</span>
<span class="p">}</span></pre></div><div class="step step-level-1 text-small" step="35" data-x="24685" data-y="27050" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="0.6" data-z="0"><pre class="highlight code xml"><span class="nt">&lt;object</span> <span class="na">uid=</span><span class="s">"imageUID"</span> <span class="na">type=</span><span class="s">"::fwData::Image"</span><span class="nt">&gt;</span>

    ...

    <span class="nt">&lt;service</span> <span class="na">uid=</span><span class="s">"myVisu"</span> <span class="na">impl=</span><span class="s">"vtkSimpleNegatoRenderer"</span> <span class="na">type=</span><span class="s">"IRender"</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;service</span> <span class="na">uid=</span><span class="s">"myReader"</span> <span class="na">impl=</span><span class="s">"VtkImageReader"</span> <span class="na">type=</span><span class="s">"IReader"</span> <span class="nt">&gt;</span>
        <span class="nt">&lt;filename</span> <span class="na">path=</span><span class="s">"./TutoData/patient1.vtk"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/service&gt;</span>

    <span class="nt">&lt;connect&gt;</span>
        <span class="nt">&lt;signal&gt;</span>imageUID/modified<span class="nt">&lt;/signal&gt;</span>
        <span class="nt">&lt;slot&gt;</span>myVisu/update<span class="nt">&lt;/slot&gt;</span>
    <span class="nt">&lt;/connect&gt;</span>

    <span class="nt">&lt;start</span> <span class="na">uid=</span><span class="s">"myFrame"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;start</span> <span class="na">uid=</span><span class="s">"myVisu"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;start</span> <span class="na">uid=</span><span class="s">"myReader"</span><span class="nt">/&gt;</span>

<span class="nt">&lt;/object&gt;</span></pre></div><div class="step step-level-1 square-background" step="36" data-y="28550" data-rotate-z="180" data-rotate-x="0" data-rotate-y="0" data-scale="0.6" data-x="24645" data-z="0"><h1 id="id2">Outline</h1><ul><li>Object/Service approach</li><li>Communication</li><li><em>Component based approach</em></li><li>Discussion</li><li>Getting started</li></ul></div><div class="step step-level-1" step="37" data-x="23145" data-rotate-x="0" data-rotate-y="0" data-rotate-z="180" data-scale="0.6" data-y="30050" data-z="0"><h1 id="component-in-fw4spl">Component in FW4SPL</h1><ul><li>Also called <em>Bundle</em></li><li>Dynamic library, loaded on demand</li><li>Group services, by theme and/or by dependency</li><li><dl><dt>Examples:</dt><dd><ul><li><strong>ioVTK</strong>: reading/writing image or mesh data from VTK formats</li><li><strong>uiImageQt</strong>: Qt widgets to manipulate images</li></ul></dd></dl></li></ul></div><div class="step step-level-1" step="38" data-rotate-x="0" data-rotate-y="0" data-rotate-z="180" data-scale="0.6" data-x="21645" data-y="31550" data-z="0"><h1 id="component-based-approach">Component based approach</h1><h2 id="benefits">Benefits</h2><ul><li>Code reuse without recompiling</li><li>Improve external dependencies management (VTK, ITK, Qt,...)</li><li>Easier support</li><li>Easier collaborative work</li></ul><h2 id="examples">Examples</h2><ul><li>Eclipse,...</li></ul><div class="notes"><ul><li>Code split</li><li>Reuse code in another application, without recompiling your program, even no link of your application against a library</li><li>Easier support EXAMPLE correction of bug</li></ul></div></div><div class="step step-level-1" step="39" data-rotate-x="0" data-rotate-y="0" data-rotate-z="180" data-scale="0.6" data-x="20145" data-y="33050" data-z="0"><h1 id="content-of-a-bundle">Content of a Bundle</h1><ul><li>Xml description file : <strong>plugin.xml</strong></li><li>Library binary ( .so, .dll, .dylib)</li><li>Other shared resources ( icons, sounds, ... )</li></ul><div class="notes"><ul><li>When a Bundle is compiled</li><li>Xml description file ( plugin.xml ) to describe the content of the dynamic library</li></ul></div></div><div class="step step-level-1 text-small" step="40" data-rotate-x="0" data-rotate-y="0" data-rotate-z="180" data-scale="0.6" data-x="18645" data-y="34550" data-z="0"><h1 id="extract-of-plugin-xml-ioitk">Extract of plugin.xml (ioITK)</h1><pre class="highlight code xml"><span class="nt">&lt;plugin</span> <span class="na">id=</span><span class="s">"ioITK"</span> <span class="na">class=</span><span class="s">"ioITK::Plugin"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;library</span> <span class="na">name=</span><span class="s">"ioITK"</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;requirement</span> <span class="na">id=</span><span class="s">"io"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;requirement</span> <span class="na">id=</span><span class="s">"gui"</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;extension</span> <span class="na">implements=</span><span class="s">"::fwServices::registry::ServiceFactory"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;type&gt;</span>::io::IReader<span class="nt">&lt;/type&gt;</span>
        <span class="nt">&lt;service&gt;</span>::ioITK::InrImageReaderService<span class="nt">&lt;/service&gt;</span>
        <span class="nt">&lt;object&gt;</span>::fwData::Image<span class="nt">&lt;/object&gt;</span>
        <span class="nt">&lt;desc&gt;</span>Inrimage Reader (ITK/Ircad)<span class="nt">&lt;/desc&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>

    <span class="nt">&lt;extension</span> <span class="na">implements=</span><span class="s">"::fwServices::registry::ServiceFactory"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;type&gt;</span>::io::IWriter<span class="nt">&lt;/type&gt;</span>
        <span class="nt">&lt;service&gt;</span>::ioITK::InrImageWriterService<span class="nt">&lt;/service&gt;</span>
        <span class="nt">&lt;object&gt;</span>::fwData::Image<span class="nt">&lt;/object&gt;</span>
        <span class="nt">&lt;desc&gt;</span>Inrimage Writer (ITK/Ircad)<span class="nt">&lt;/desc&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>

    <span class="nt">&lt;extension</span> <span class="na">implements=</span><span class="s">"::fwServices::registry::ServiceFactory"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;type&gt;</span>::io::IWriter<span class="nt">&lt;/type&gt;</span>
        <span class="nt">&lt;service&gt;</span>::ioITK::JpgImageWriterService<span class="nt">&lt;/service&gt;</span>
        <span class="nt">&lt;object&gt;</span>::fwData::Image<span class="nt">&lt;/object&gt;</span>
        <span class="nt">&lt;desc&gt;</span>Jpeg Writer (ITK)<span class="nt">&lt;/desc&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>
    ...
<span class="nt">&lt;/plugin&gt;</span></pre><div class="notes"><ul><li>This shows how to register services in the factory</li><li>This helps to load bundles dynamically</li><li>Don't talk about extension points</li></ul></div></div><div class="step step-level-1" step="41" data-rotate-x="0" data-rotate-y="0" data-rotate-z="180" data-scale="0.6" data-x="17145" data-y="36050" data-z="0"><h1 id="bundles-in-application">Bundles in application</h1><p><em>profile.xml</em></p><ul><li>Input file for the launcher</li><li>Describe which bundles to use</li></ul></div><div class="step step-level-1 text-small" step="42" data-y="35730" data-rotate-x="0" data-rotate-y="0" data-rotate-z="180" data-scale="0.6" data-x="15645" data-z="0"><pre class="highlight code">&lt;profile name="TestApp" version="0.1.0"&gt;

        &lt;activate id="dataReg" version="0-1" /&gt;

        &lt;activate id="gui" version="0-1" /&gt;
        &lt;activate id="guiQt" version="0-1" /&gt;

        &lt;activate id="io" version="0-1" /&gt;
        &lt;activate id="ioVTK" version="0-1" /&gt;

        &lt;activate id="media" version="0-1" /&gt;

        &lt;activate id="visu" version="0-1" /&gt;
        &lt;activate id="visuVTK" version="0-1" /&gt;
        &lt;activate id="visuVTKQt" version="0-1" /&gt;

        &lt;activate id="TestApp" /&gt;
        &lt;activate id="appXml" version="0-1" &gt;
            &lt;param id="config" value="TestAppBase" /&gt;
            &lt;param id="parameters" value="TestAppBase" /&gt;
        &lt;/activate&gt;

        &lt;start id="visuVTK" /&gt;
        &lt;start id="visuVTKQt" /&gt;
        &lt;start id="guiQt" /&gt;
        &lt;start id="appXml" /&gt;

&lt;/profile&gt;</pre></div><div class="step step-level-1" step="43" data-x="14145" data-rotate-x="0" data-rotate-y="0" data-rotate-z="180" data-scale="0.6" data-y="35410" data-z="0"><h1 id="example-i-o-bundles">Example : I/O Bundles</h1><video width="800" height="600" controls>
   <source src="https://www.flickr.com/video_download.gne?id=23707070182" >
   Your browser does not support the video tag.
</video><div class="notes"><ul><li>Switch GUI !!!</li></ul></div></div><div class="step step-level-1 square-background" step="44" data-y="14910" data-rotate-z="270" data-rotate-x="0" data-rotate-y="0" data-scale="0.6" data-x="12645" data-z="0"><h1 id="id3">Outline</h1><ul><li>Object/Service approach</li><li>Communication</li><li>Component based approach</li><li><em>Discussion</em></li><li>Getting started</li></ul></div><div class="step step-level-1" step="45" data-y="13410" data-rotate-x="0" data-rotate-y="0" data-rotate-z="270" data-scale="0.6" data-x="11145" data-z="0"><h1 id="design-of-a-new-application">Design of a new application</h1><ul><li>Write a new xml configuration file (plugin.xml)</li><li>Pick the bundles you need (profile.xml)</li><li>Write new services</li><li>Create new bundles/libraries</li><li>Share common code in regular shared libraries (<em>.so,</em>.dll)</li></ul></div><div class="step step-level-1" step="46" data-rotate-x="0" data-rotate-y="0" data-rotate-z="270" data-scale="0.6" data-x="9645" data-y="11910" data-z="0"><h1 id="discussion">Discussion</h1><p><em>Services and components</em></p><p><strong>Cons</strong></p><ul><li>Think design differently</li><li>Need to write a new class for each new functionality</li></ul><p><strong>Pros</strong></p><ul><li>Far less coupling !</li><li>No need for a public and private API</li></ul></div><div class="step step-level-1 square-background" step="47" data-rotate-z="90" data-x="11145" data-rotate-x="0" data-rotate-y="0" data-scale="0.6" data-y="10410" data-z="0"><h1 id="id4">Outline</h1><ul><li>Object/Service approach</li><li>Communication</li><li>Component based approach</li><li>Discussion</li><li><em>Getting started</em></li></ul></div><div class="step step-level-1" step="48" data-y="11910" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="0.6" data-x="12645" data-z="0"><h1 id="online-documentation">Online documentation</h1><ul><li>Documentation <a href="http://fw4spl-doc.readthedocs.org/">http://fw4spl-doc.readthedocs.org/</a></li><li>Developper blog <a href="http://fw4spl-org.github.io/fw4spl-blog/">http://fw4spl-org.github.io/fw4spl-blog/</a></li></ul></div><div class="step step-level-1" step="49" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="0.6" data-x="14145" data-y="13410" data-z="0"><h1 id="downloading-fw4spl">Downloading FW4SPL</h1><ul><li>Github : <a href="https://github.com/fw4spl-org">https://github.com/fw4spl-org</a></li><li>BitBucket : <a href="https://bitbucket.org/fw4splorg">https://bitbucket.org/fw4splorg</a></li><li>Do not use the obsolete googlecode page !!! <a href="https://code.google.com/p/fw4spl/">https://code.google.com/p/fw4spl/</a></li></ul><div class="notes"><ul><li>googlecode may still be in the search engine results</li></ul></div></div><div class="step step-level-1" step="50" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="0.6" data-x="15645" data-y="14910" data-z="0"><h1 id="which-version-to-use">Which version to use ?</h1><h2 id="current-stable-version-0-10-1">Current stable version : 0.10.1</h2><h2 id="current-development-version-0-10-2">Current development version : 0.10.2</h2><ul><li>Strongly advised for a new software (communication API is simpler)</li><li>Temporarily we need patches repositories, only available on bitbucket</li></ul><pre class="highlight code bash">hg qclone https://bitbucket.org/fw4splorg/fw4spl-patches</pre></div><div class="step step-level-1" step="51" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="0.6" data-x="17145" data-y="16410" data-z="0"><h1 id="repositories">Repositories</h1><table cellpadding="0" cellspacing="0"><thead><tr><th><p>Type</p></th><th><p>Sources</p></th><th><p>Dependencies</p></th></tr></thead><tbody><tr><td><p>Main</p></td><td><p>fw4spl</p></td><td><p>fw4spl-deps</p></td></tr><tr><td><p>Extended</p></td><td><p>fw4spl-ext</p></td><td><p>fw4spl-ext-deps</p></td></tr><tr><td><p>AR</p></td><td><p>fw4spl-ar</p></td><td><p>fw4spl-ar-deps</p></td></tr></tbody></table><h2 id="third-part-libraries">Third-part libraries</h2><ul><li>Build scripts (CMake ExternalProject_Add())</li></ul><div class="notes"><ul><li>dependencies = external libraries (examples)</li><li>before building fw4spl, you must build dependencies</li><li>extended : work in progress</li></ul></div></div><div class="step step-level-1" step="52" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="0.6" data-x="18645" data-y="17910" data-z="0"><h1 id="main-repository-fw4spl">Main repository <em>(fw4spl)</em></h1><ul><li>Basic data (Float, Integer, String, Image, Mesh,... )</li><li>GUI (Qt)</li><li>Data I/O (JSON, DICOM (gdcm), VTK, Inr)</li><li>2D rendering (Qt)</li><li>3D rendering (VTK)</li><li>Around 15 tutorials</li></ul></div><div class="step step-level-1" step="53" data-x="18325" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="0.6" data-y="19410" data-z="0"><video width="800" height="600" controls>
   <source src="https://www.flickr.com/video_download.gne?id=23732849331" >
   Your browser does not support the video tag.
</video><ul><li>Medical images viewer : <strong>VR-Render</strong></li></ul></div><div class="step step-level-1" step="54" data-x="17975" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="0.6" data-y="20910" data-z="0"><video width="800" height="600" controls>
   <source src="https://www.flickr.com/video_download.gne?id=23187154854" >
   Your browser does not support the video tag.
</video></div><div class="step step-level-1" step="55" data-y="22410" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="0.6" data-x="17625" data-z="0"><h1 id="extended-repository-fw4spl-ext">Extended repository <em>(fw4spl-ext)</em></h1><ul><li>DICOM (dcmtk)</li><li>OpenIGTLink support</li></ul></div><div class="step step-level-1" step="56" data-x="17325" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="0.6" data-y="23910" data-z="0"><video width="800" height="600" controls>
   <source src="https://www.flickr.com/video_download.gne?id=23519652480" >
   Your browser does not support the video tag.
</video></div><div class="step step-level-1" step="57" data-y="25410" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="0.6" data-x="17025" data-z="0"><h1 id="augmented-reality-repository-fw4spl-ar">Augmented reality repository <em>(fw4spl-ar)</em></h1><ul><li>Video player (<strong>QtMultimedia</strong>): file, camera or network</li><li>Tag-based video tracking (<strong>Aruco</strong>, <strong>OpenCV</strong>)</li><li><em>ARCalibration</em> : Camera calibration (mono, stereo)</li></ul></div><div class="step step-level-1" step="58" data-x="16705" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="0.6" data-y="26910" data-z="0"><video width="800" height="600" controls>
   <source src="https://www.flickr.com/video_download.gne?id=23707101372" >
   Your browser does not support the video tag.
</video><ul><li><em>DroidTracking</em> : Tag tracking on Android devices</li></ul></div><div class="step step-level-1" step="59" data-x="16355" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="0.6" data-y="28410" data-z="0"><video width="800" height="600" controls>
   <source src="https://www.flickr.com/video_download.gne?id=23789374406" >
   Your browser does not support the video tag.
</video></div><div class="step step-level-1" step="60" data-y="29910" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="0.6" data-x="16005" data-z="0"><h1 id="debian-integration">Debian Integration</h1><ul><li>Available on <a href="https://packages.debian.org/testing/science/fw4spl">testing</a></li><li>Previous stable version 0.9.2</li><li>Ready to use !</li></ul></div><div class="step step-level-1" step="61" data-y="30910" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="0.6" data-x="15655" data-z="0"><h1 id="stay-tuned">Stay tuned !!!</h1><h2 id="coming-in-september-2015">Coming in September 2015</h2><ul><li>Ogre3D integration : <em>fw4spl-Ogre3d</em></li><li>Advanced rendering techniques</li><li>Better performances</li></ul></div><div class="step step-level-1" step="62" data-x="15305" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="0.6" data-y="31910" data-z="0"><video width="800" height="600" controls>
   <source src="https://www.flickr.com/video_download.gne?id=23732949151" >
   Your browser does not support the video tag.
</video></div><div class="step step-level-1 centered" step="63" data-y="32910" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-scale="0.6" data-x="14955" data-z="0"><h1 id="thank-you">Thank you !</h1><p>fw4spl at gmail.com</p><p>fbridault at ircad.fr</p><p>johan.moreau at ircad.fr</p><div class="line-block"><br></br><br></br></div><blockquote><p>Presentation made with <a href="https://github.com/regebro/hovercraft">Hovercraft</a></p></blockquote></div></div><div id="hovercraft-help" class="hide"><table><tr><th>Space</th><td>Forward</td></tr><tr><th>Right, Down, Page Down</th><td>Next slide</td></tr><tr><th>Left, Up, Page Up</th><td>Previous slide</td></tr><tr><th>P</th><td>Open presenter console</td></tr><tr><th>H</th><td>Toggle this help</td></tr></table></div><script type="text/javascript" src="js/impress.js"></script><script type="text/javascript" src="js/impressConsole.js"></script><script type="text/javascript" src="js/hovercraft.js"></script></body></html>